<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Globo Terrestre - Central Marítima</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/globe.gl@2.24.0/dist/globe.gl.min.js"></script>
  <style>
    body {
      background: #000 url('veleiro1.png') no-repeat center center fixed;
      background-size: cover;
      color: #fff;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      margin: 0;
      padding: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .menu-bar {
      display: flex;
      justify-content: center;
      gap: 30px;
      padding: 15px 0;
      background-color: rgba(20, 20, 20, 0.9);
      font-weight: bold;
      position: sticky;
      top: 0;
      z-index: 1000;
      backdrop-filter: blur(5px);
    }

    .menu-bar a {
      color: white;
      text-decoration: none;
      padding: 8px 16px;
      border-radius: 30px;
      transition: all 0.3s ease;
      background: rgba(0, 0, 30, 0.5);
      border: 1px solid rgba(0, 209, 255, 0.3);
    }

    .menu-bar a:hover {
      background-color: rgba(0, 209, 255, 0.2);
      transform: translateY(-2px);
    }

    .menu-bar .active {
      background-color: rgba(0, 209, 255, 0.3);
      box-shadow: 0 0 15px rgba(0, 209, 255, 0.5);
    }

    h1 {
      text-align: center;
      margin: 1.5rem auto 1rem;
      font-size: 2.2rem;
      background: linear-gradient(135deg, rgba(31, 31, 31, 0.8), rgba(20, 20, 40, 0.9));
      padding: 15px 30px;
      border-radius: 50px;
      display: inline-block;
      border: 1px solid rgba(0, 209, 255, 0.3);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
      font-weight: 600;
      letter-spacing: 1px;
    }

    main {
      flex: 1;
      padding: 1rem;
      max-width: 100%;
      margin: 0 auto;
      width: 100%;
    }

    .globe-container {
      display: flex;
      flex-wrap: nowrap;
      gap: 20px;
      height: 75vh;
      max-height: 700px;
      margin: 0 auto;
      max-width: 1400px;
      background: rgba(20, 30, 50, 0.6);
      border-radius: 20px;
      padding: 20px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(5px);
      border: 1px solid rgba(0, 209, 255, 0.2);
    }

    .control-panel {
      background: linear-gradient(145deg, rgba(30, 40, 60, 0.9), rgba(20, 25, 45, 0.95));
      border-radius: 15px;
      padding: 20px;
      width: 300px;
      min-width: 300px;
      overflow-y: auto;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      border: 1px solid rgba(0, 209, 255, 0.2);
    }

    .globe-wrapper {
      flex: 1;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 0 30px rgba(0, 0, 0, 0.7);
      border: 1px solid rgba(0, 209, 255, 0.3);
      background: rgba(0, 10, 20, 0.7);
    }

    #globeViz {
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.2);
    }

    .panel-title {
      color: #00d1ff;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      padding-bottom: 12px;
      margin-bottom: 20px;
      font-size: 1.3rem;
      text-align: center;
      font-weight: 600;
      letter-spacing: 0.5px;
      text-shadow: 0 0 10px rgba(0, 209, 255, 0.5);
    }

    .input-group {
      margin-bottom: 20px;
      position: relative;
    }

    .input-group label {
      display: block;
      margin-bottom: 8px;
      color: #aad;
      font-size: 0.95rem;
      font-weight: 500;
    }

    .input-group input {
      width: 100%;
      padding: 12px 15px;
      background: rgba(10, 20, 40, 0.7);
      border: 1px solid rgba(0, 209, 255, 0.3);
      border-radius: 10px;
      color: #fff;
      font-size: 1.05rem;
      font-family: 'Courier New', monospace;
      transition: all 0.3s ease;
    }

    .input-group input:focus {
      outline: none;
      border-color: #00d1ff;
      box-shadow: 0 0 10px rgba(0, 209, 255, 0.5);
      background: rgba(15, 30, 60, 0.8);
    }

    .input-group .symbols {
      position: absolute;
      top: 38px;
      right: 15px;
      color: rgba(255, 255, 255, 0.5);
      font-size: 0.9rem;
      pointer-events: none;
    }

    .btn-container {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 15px;
    }

    .btn {
      flex: 1;
      min-width: 120px;
      padding: 12px;
      background: linear-gradient(135deg, #006080, #004060);
      color: white;
      border: none;
      border-radius: 10px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-align: center;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
    }

    .btn:hover {
      background: linear-gradient(135deg, #0080a0, #006080);
      transform: translateY(-3px);
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.4);
    }

    .btn:active {
      transform: translateY(1px);
    }

    .btn-danger {
      background: linear-gradient(135deg, #a02000, #801a00);
    }

    .btn-danger:hover {
      background: linear-gradient(135deg, #c03000, #a02000);
    }

    .coordinates-list {
      max-height: 300px;
      overflow-y: auto;
      margin-top: 15px;
      padding: 15px;
      background: rgba(10, 20, 40, 0.5);
      border-radius: 10px;
      border: 1px solid rgba(0, 209, 255, 0.2);
    }

    .coordinates-list ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .coordinates-list li {
      padding: 12px 15px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      font-size: 0.95rem;
      background: rgba(15, 25, 45, 0.5);
      border-radius: 8px;
      margin-bottom: 8px;
      transition: all 0.3s ease;
    }

    .coordinates-list li:last-child {
      border-bottom: none;
      margin-bottom: 0;
    }

    .coordinates-list li:hover {
      background: rgba(20, 40, 70, 0.7);
      transform: translateX(5px);
    }

    .coord-actions {
      display: flex;
      gap: 10px;
      margin-top: 8px;
    }

    .coord-actions button {
      flex: 1;
      background: rgba(0, 209, 255, 0.15);
      border: 1px solid rgba(0, 209, 255, 0.4);
      color: #00d1ff;
      border-radius: 6px;
      padding: 6px;
      font-size: 0.85rem;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .coord-actions button:hover {
      background: rgba(0, 209, 255, 0.3);
      transform: translateY(-2px);
    }

    .last-point {
      padding: 15px;
      background: rgba(10, 30, 60, 0.7);
      border-radius: 10px;
      margin-bottom: 20px;
      border: 1px solid rgba(0, 209, 255, 0.3);
      font-size: 0.95rem;
    }

    .last-point strong {
      color: #00d1ff;
      display: block;
      margin-bottom: 5px;
    }

    .footer {
      text-align: center;
      padding: 1.2rem;
      font-size: 0.95rem;
      color: #aad;
      background: rgba(10, 15, 30, 0.8);
      margin-top: auto;
      border-top: 1px solid rgba(0, 209, 255, 0.2);
      backdrop-filter: blur(5px);
    }

    /* Scrollbar styling */
    .coordinates-list::-webkit-scrollbar {
      width: 8px;
    }

    .coordinates-list::-webkit-scrollbar-track {
      background: rgba(10, 20, 40, 0.3);
      border-radius: 4px;
    }

    .coordinates-list::-webkit-scrollbar-thumb {
      background: rgba(0, 209, 255, 0.5);
      border-radius: 4px;
    }

    .coordinates-list::-webkit-scrollbar-thumb:hover {
      background: rgba(0, 209, 255, 0.7);
    }

    @media (max-width: 1000px) {
      .globe-container {
        flex-direction: column;
        height: auto;
      }
      
      .control-panel {
        width: 100%;
        min-width: auto;
      }
      
      .globe-wrapper {
        height: 60vh;
        min-height: 400px;
      }
      
      .menu-bar {
        flex-wrap: wrap;
        gap: 10px;
      }
      
      .menu-bar a {
        padding: 6px 12px;
        font-size: 0.9rem;
      }
      
      h1 {
        font-size: 1.8rem;
        padding: 10px 20px;
      }
    }

    @media (max-width: 600px) {
      .btn {
        min-width: 100%;
      }
    }
  </style>
</head>
<body>

  <!-- Barra de Menu -->
  <div class="menu-bar">
    <a href="prompts.html">Prompts</a>
    <a href="como-usar.html">Como Usar</a>
    <a href="ias.html">IAs</a>
    <a href="sistemas.html">Sistemas</a>
    <a href="noticias.html">Notícias</a>
    <a href="globo.html">Globo</a>
    <a href="linksuteis.html">Links Úteis</a>
  </div>

  <!-- Título -->
  <h1>Globo Terrestre Interativo</h1>

  <!-- Conteúdo Principal -->
  <main>
    <div class="globe-container">
      <!-- Painel de Controle Esquerdo -->
      <div class="control-panel">
        <div class="panel-title">Adicionar Coordenadas</div>
        
        <div class="input-group">
          <label for="latitude">Latitude (ex: 23º30'15"S)</label>
          <input type="text" id="latitude" placeholder="00º00'00&quot;S" maxlength="11">
          <div class="symbols">º '"</div>
        </div>
        
        <div class="input-group">
          <label for="longitude">Longitude (ex: 046º30'15"W)</label>
          <input type="text" id="longitude" placeholder="000º00'00&quot;W" maxlength="12">
          <div class="symbols">º '"</div>
        </div>
        
        <div class="btn-container">
          <button id="addPointBtn" class="btn">Adicionar Ponto</button>
          <button id="drawRouteBtn" class="btn">Traçar Rota</button>
          <button id="clearPointsBtn" class="btn btn-danger">Limpar Pontos</button>
        </div>
      </div>
      
      <!-- Globo Terrestre -->
      <div class="globe-wrapper">
        <div id="globeViz"></div>
      </div>
      
      <!-- Painel de Informações Direito -->
      <div class="control-panel">
        <div class="panel-title">Pontos Marcados</div>
        
        <div class="last-point">
          <strong>Último ponto adicionado:</strong>
          <span id="lastPoint">Nenhum ponto adicionado</span>
        </div>
        
        <div class="coordinates-list">
          <div class="panel-title">Lista de Pontos</div>
          <ul id="pointsList">
            <li>Nenhum ponto adicionado</li>
          </ul>
        </div>
      </div>
    </div>
  </main>

  <!-- Rodapé -->
  <div class="footer">
    &copy; 2025 Central Marítima e Operacional | Todos os direitos reservados.
  </div>

  <script>
    // Função para converter coordenadas DMS para decimais
    function dmsToDecimal(dms) {
      // Extrai graus, minutos, segundos e direção
      const regex = /(\d{1,3})[º°](\d{1,2})['′](\d{1,2}(?:\.\d+)?)["″]?([NSEWnsew])/;
      const matches = dms.match(regex);
      
      if (!matches) {
        // Tentar formato alternativo sem segundos
        const regexAlt = /(\d{1,3})[º°](\d{1,2}(?:\.\d+)?)['′]?([NSEWnsew])/;
        const matchesAlt = dms.match(regexAlt);
        if (!matchesAlt) return null;
        
        const degrees = parseFloat(matchesAlt[1]);
        const minutes = parseFloat(matchesAlt[2]);
        const seconds = 0;
        const direction = matchesAlt[3].toUpperCase();
        
        let decimal = degrees + minutes/60;
        if (direction === 'S' || direction === 'W') decimal = -decimal;
        return decimal;
      }
      
      const degrees = parseFloat(matches[1]);
      const minutes = parseFloat(matches[2]);
      const seconds = parseFloat(matches[3]);
      const direction = matches[4].toUpperCase();
      
      // Calcula o valor decimal
      let decimal = degrees + minutes/60 + seconds/3600;
      
      // Aplica a direção (S e W são negativos)
      if (direction === 'S' || direction === 'W') {
        decimal = -decimal;
      }
      
      return decimal;
    }

    // Função para converter decimais para DMS
    function decimalToDMS(decimal, isLatitude) {
      // Determina a direção baseada no tipo (latitude ou longitude)
      const directions = isLatitude ? ['N', 'S'] : ['E', 'W'];
      const direction = decimal >= 0 ? directions[0] : directions[1];
      
      // Converte para valor absoluto
      const absDecimal = Math.abs(decimal);
      
      // Calcula graus, minutos e segundos
      const degrees = Math.floor(absDecimal);
      const minutesDecimal = (absDecimal - degrees) * 60;
      const minutes = Math.floor(minutesDecimal);
      const seconds = Math.round((minutesDecimal - minutes) * 60 * 100) / 100;
      
      // Formata para DMS
      return `${degrees}º${minutes}'${seconds.toFixed(2)}"${direction}`;
    }

    // Máscara de entrada para coordenadas
    function setupInputMask() {
      const latInput = document.getElementById('latitude');
      const lngInput = document.getElementById('longitude');
      
      // Máscara para latitude
      latInput.addEventListener('input', function(e) {
        let value = e.target.value.replace(/[^\dº'"NSns]/g, '');
        
        // Limitar o comprimento
        if (value.length > 11) value = value.substring(0, 11);
        
        // Inserir automaticamente os símbolos
        if (value.length > 0 && !value.includes('º')) {
          value = value.replace(/(\d{2})/, '$1º');
        }
        if (value.length > 3 && !value.includes("'")) {
          value = value.replace(/(\d{2}º\d{2})/, "$1'");
        }
        if (value.length > 6 && !value.includes('"')) {
          value = value.replace(/(\d{2}º\d{2}'\d{2})/, '$1"');
        }
        if (value.length > 9 && !['N','S','n','s'].includes(value.charAt(value.length-1))) {
          value = value.replace(/(\d{2}º\d{2}'\d{2}")/, '$1');
          value += 'S'; // Assume Sul por padrão, mas pode ser alterado
        }
        
        e.target.value = value;
      });
      
      // Máscara para longitude
      lngInput.addEventListener('input', function(e) {
        let value = e.target.value.replace(/[^\dº'"WWEe]/g, '');
        
        // Limitar o comprimento
        if (value.length > 12) value = value.substring(0, 12);
        
        // Inserir automaticamente os símbolos
        if (value.length > 0 && !value.includes('º')) {
          value = value.replace(/(\d{3})/, '$1º');
        }
        if (value.length > 4 && !value.includes("'")) {
          value = value.replace(/(\d{3}º\d{2})/, "$1'");
        }
        if (value.length > 7 && !value.includes('"')) {
          value = value.replace(/(\d{3}º\d{2}'\d{2})/, '$1"');
        }
        if (value.length > 10 && !['W','E','w','e'].includes(value.charAt(value.length-1))) {
          value = value.replace(/(\d{3}º\d{2}'\d{2}")/, '$1');
          value += 'W'; // Assume Oeste por padrão
        }
        
        e.target.value = value;
      });
    }

    // Dados da aplicação
    let points = [];
    let routes = [];
    
    // Elementos DOM
    const addPointBtn = document.getElementById('addPointBtn');
    const drawRouteBtn = document.getElementById('drawRouteBtn');
    const clearPointsBtn = document.getElementById('clearPointsBtn');
    const pointsList = document.getElementById('pointsList');
    const lastPointEl = document.getElementById('lastPoint');
    
    // Inicializar o globo
    const globe = Globe()
      .globeImageUrl('https://unpkg.com/three-globe/example/img/earth-blue-marble.jpg')
      .bumpImageUrl('https://unpkg.com/three-globe/example/img/earth-topology.png')
      .backgroundColor('rgba(0,0,0,0)')
      .showAtmosphere(true)
      .atmosphereColor('rgba(0, 209, 255, 0.2)')
      .width(document.querySelector('.globe-wrapper').offsetWidth)
      .height(document.querySelector('.globe-wrapper').offsetHeight)
      (document.getElementById('globeViz'));
    
    // Configurações adicionais do globo
    globe.controls().enableZoom = true;
    globe.controls().autoRotate = false;
    globe.controls().autoRotateSpeed = 0.8;
    
    // Ajustar tamanho do globo ao redimensionar a janela
    window.addEventListener('resize', () => {
      const wrapper = document.querySelector('.globe-wrapper');
      globe.width(wrapper.offsetWidth).height(wrapper.offsetHeight);
    });
    
    // Função para adicionar ponto
    function addPoint() {
      const latDMS = document.getElementById('latitude').value.trim();
      const lngDMS = document.getElementById('longitude').value.trim();
      
      if (!latDMS || !lngDMS) {
        alert('Por favor, preencha ambos os campos!');
        return;
      }
      
      // Converter DMS para decimal
      const lat = dmsToDecimal(latDMS);
      const lng = dmsToDecimal(lngDMS);
      
      if (lat === null || lng === null) {
        alert('Formato de coordenada inválido! Use o formato: 23º30\'15"S ou 046º30\'15"W');
        return;
      }
      
      // Criar ponto com ID único
      const id = Date.now().toString();
      points.push({ id, lat, lng, latDMS, lngDMS });
      
      // Atualizar o globo
      updateGlobePoints();
      
      // Atualizar a lista de pontos
      updatePointsList();
      
      // Atualizar último ponto
      lastPointEl.textContent = `${latDMS}/${lngDMS}`;
      
      // Limpar campos
      document.getElementById('latitude').value = '';
      document.getElementById('longitude').value = '';
      document.getElementById('latitude').focus();
    }
    
    // Função para atualizar os pontos no globo
    function updateGlobePoints() {
      globe.pointsData(points);
      globe.pointColor(() => '#ff4081');
      globe.pointAltitude(0.05);
      globe.pointRadius(0.25);
      globe.pointLabel(p => `${p.latDMS}/${p.lngDMS}`);
    }
    
    // Função para atualizar a lista de pontos
    function updatePointsList() {
      pointsList.innerHTML = '';
      
      if (points.length === 0) {
        pointsList.innerHTML = '<li>Nenhum ponto adicionado</li>';
        return;
      }
      
      points.forEach((point, index) => {
        const li = document.createElement('li');
        li.innerHTML = `
          <div><strong>Ponto ${index + 1}:</strong> ${point.latDMS}/${point.lngDMS}</div>
          <div class="coord-actions">
            <button onclick="focusPoint(${point.lat}, ${point.lng})">Focar</button>
            <button onclick="removePoint('${point.id}')">Remover</button>
          </div>
        `;
        pointsList.appendChild(li);
      });
    }
    
    // Função para focar em um ponto
    window.focusPoint = function(lat, lng) {
      globe.pointOfView({ lat, lng, altitude: 1.5 }, 1000);
    };
    
    // Função para remover um ponto
    window.removePoint = function(id) {
      points = points.filter(point => point.id !== id);
      updateGlobePoints();
      updatePointsList();
      
      if (points.length === 0) {
        lastPointEl.textContent = 'Nenhum ponto adicionado';
      } else {
        const lastPoint = points[points.length - 1];
        lastPointEl.textContent = `${lastPoint.latDMS}/${lastPoint.lngDMS}`;
      }
    };
    
    // Função para traçar rota
    function drawRoute() {
      if (points.length < 2) {
        alert('Adicione pelo menos 2 pontos para traçar uma rota!');
        return;
      }
      
      routes = [];
      for (let i = 0; i < points.length - 1; i++) {
        routes.push({
          startLat: points[i].lat,
          startLng: points[i].lng,
          endLat: points[i+1].lat,
          endLng: points[i+1].lng,
          color: ['#4fc3f7', '#00b0ff']
        });
      }
      
      globe.arcsData(routes);
      globe.arcColor('color');
      globe.arcDashLength(0.5);
      globe.arcDashGap(1);
      globe.arcDashAnimateTime(1000);
      globe.arcStroke(0.3);
    }
    
    // Função para limpar todos os pontos
    function clearPoints() {
      points = [];
      routes = [];
      updateGlobePoints();
      updatePointsList();
      globe.arcsData([]);
      lastPointEl.textContent = 'Nenhum ponto adicionado';
      
      // Mostrar mensagem de confirmação
      const confirmation = document.createElement('div');
      confirmation.textContent = 'Todos os pontos foram removidos!';
      confirmation.style.position = 'fixed';
      confirmation.style.bottom = '20px';
      confirmation.style.left = '50%';
      confirmation.style.transform = 'translateX(-50%)';
      confirmation.style.padding = '10px 20px';
      confirmation.style.background = 'rgba(0, 100, 0, 0.8)';
      confirmation.style.color = 'white';
      confirmation.style.borderRadius = '30px';
      confirmation.style.zIndex = '1000';
      confirmation.style.boxShadow = '0 4px 15px rgba(0,0,0,0.5)';
      document.body.appendChild(confirmation);
      
      setTimeout(() => {
        document.body.removeChild(confirmation);
      }, 2000);
    }
    
    // Event Listeners
    addPointBtn.addEventListener('click', addPoint);
    drawRouteBtn.addEventListener('click', drawRoute);
    clearPointsBtn.addEventListener('click', clearPoints);
    
    // Adicionar ponto ao clicar no globo
    globe.onGlobeClick(({ lat, lng }) => {
      // Converter decimais para DMS
      const latDMS = decimalToDMS(lat, true);
      const lngDMS = decimalToDMS(lng, false);
      
      // Adicionar o ponto
      const id = Date.now().toString();
      points.push({ id, lat, lng, latDMS, lngDMS });
      
      // Atualizar interface
      updateGlobePoints();
      updatePointsList();
      lastPointEl.textContent = `${latDMS}/${lngDMS}`;
      
      // Mostrar mensagem
      const message = document.createElement('div');
      message.textContent = `Ponto adicionado: ${latDMS}/${lngDMS}`;
      message.style.position = 'fixed';
      message.style.bottom = '20px';
      message.style.left = '50%';
      message.style.transform = 'translateX(-50%)';
      message.style.padding = '10px 20px';
      message.style.background = 'rgba(0, 100, 0, 0.8)';
      message.style.color = 'white';
      message.style.borderRadius = '30px';
      message.style.zIndex = '1000';
      message.style.boxShadow = '0 4px 15px rgba(0,0,0,0.5)';
      document.body.appendChild(message);
      
      setTimeout(() => {
        document.body.removeChild(message);
      }, 2000);
    });
    
    // Configurar máscaras de entrada
    setupInputMask();
    
    // Adicionar alguns pontos iniciais para demonstração
    setTimeout(() => {
      const demoPoints = [
        { latDMS: '23º33\'00"S', lngDMS: '46º38\'00"W' },
        { latDMS: '22º54\'00"S', lngDMS: '43º12\'00"W' },
        { latDMS: '15º47\'00"S', lngDMS: '47º55\'00"W' }
      ];
      
      demoPoints.forEach(point => {
        const lat = dmsToDecimal(point.latDMS);
        const lng = dmsToDecimal(point.lngDMS);
        const id = Date.now().toString() + Math.random();
        points.push({ id, lat, lng, ...point });
      });
      
      updateGlobePoints();
      updatePointsList();
      if (points.length > 0) {
        const lastPoint = points[points.length - 1];
        lastPointEl.textContent = `${lastPoint.latDMS}/${lastPoint.lngDMS}`;
      }
    }, 1000);
  </script>
</body>
</html>
